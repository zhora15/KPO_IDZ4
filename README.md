Микросервисы приложения были реализованы на Python с помощью фреймворка Flask и библиотеки Flask-RESTful. В качестве базы данных было использована SQLite.

### Микросервис идентификации пользователей:

#### Регистрация:
Для проверки корректности (ограничение использования запрещенных символов, наличие доменного имени и зоны) имени пользователя, адреса электронной почты и пароля были использованы регулярные бибилиотеки re. Также, если пользователь не указывает в параметрах запроса обязательные поля, то выдается ошибка по отсутствию каждого из полей отдельно. Затем происходит хэширование пароля и сохранение всей информации в БД

#### Авторизация:
При попытке авторизации возращаются ошибки в случае отсутствия имени пользователя или пароля в запросе или отсутсвия такого пользователя в бд. При совпадении сохраненного хэша пароля в бд и хэша пароля из запроса идет проверка на актуальность токена и принадлежность токена данному пользователю. Если в токене зашифрован id другого пользователя, то считается, что токен украден и он удлаяется из БД и авторизация прерывается. Если токен истек, то генерируется новый токен на 12 часов и возвращается пользователю. Все изменения записываются в БД.

#### Модуль валидации пользователя:
При ответе на каждый запрос необходимо проверять, что запрос пришел от пользователя, у которого есть доступ выполнять этот запрос, поэтому данный код вынесен в отдельный модуль. В нем проверяется наличие обязательных полей для идентификации пользователя, актуальность и принадлежность переданного jwt-токена.

### Микросервис управления блюдами и заказами:

#### Добавление блюд
Происходит идентификация пользователя. Если пользователь является шефом, то ему дозволено добавить новое блюдо. При добавлении блюда проверяется валидность количества и цены и выполняется добавление в БД.

#### Создание заказа
Происходит идентификация пользователя. Если пользователь является клиентов, то ему дозволено добавить новое блюдо. При добавлении каждого блюда проверяется существование блюд и валидность количества запрашиваемых блюд (больше нуля и не более существующего количества). При успешном добавлении всех блюд в заказ отправляется соответствующий запрос, иначе заказ не создан, то БД очищается от созданных записей для этого заказа и пользователю возращается причина ошибки.

#### Изменение блюда
Происходит идентификация пользователя. Если пользователь является менеджер, то ему дозволено изменить блюдо. В одном запросе можно изменить цену и/или количесвто доступных блюд. Если в запросе нет измениния ни того, ни другого, то выводится ошибка. Также проверяется валидность количества блюд и их стоимости

#### Запрос меню
Происходит идентификация пользователя. Возвращаютс явсе блюда доступные для заказа в качестве массива в json

####  Изменение заказа
Происходит идентификация пользователя. Если пользователь является менеджер, то ему дозволено изменить статус заказа. Проверяется ввалидность статуса заказа и выполняется запрос в БД.

### Формирование API
В файле ```app.py``` свяpываются конечные точки api с функциями обработки запросов

### Примеры запросов с помощью requests
#### Регистрация
```res = requests.post("http://127.0.0.1:5000/api/register_user", json={"email": "ulik@gmail.com", "username": "ulik", "password": "26052003", "role": "client"})```
```res = requests.post("http://127.0.0.1:5000/api/register_user", json={"email": "zhora@gmail.com", "username": "zhora", "password": "26052003", "role": "chef"})```
```requests.post("http://127.0.0.1:5000/api/register_user", json={"email": "irlan@gmail.com", "username": "irlan", "password": "26052003", "role": "manager"})```
#### Авторизация
```ulik_t = requests.post("http://127.0.0.1:5000/api/auth_user", json={"username": "ulik", "password": "26052003"}).json['token'] ```
```zhora_t = requests.post("http://127.0.0.1:5000/api/auth_user", json={"username": "zhora", "password": "26052003"}).json['token'] ```
```irlan_t = requests.post("http://127.0.0.1:5000/api/auth_user", json={"username": "irlan", "password": "26052003"}).json['token'] ```
#### Добавление блюд
```requests.post("http://127.0.0.1:5000/api/add_dish", json={"username": "zhora", "token": zhora_t, "name": "potato", "description": "Farsh", "price": 200, "quantity": 4})```
```requests.post("http://127.0.0.1:5000/api/add_dish", json={"username": "zhora", "token": zhora_t, "name": "burger", "description": "Farsh", "price": 200, "quantity": 10})```
```requests.post("http://127.0.0.1:5000/api/add_dish", json={"username": "zhora", "token": zhora_t, "name": "cheese balls", "description": "Farsh", "price": 200, "quantity": 2 })```
#### Запрос меню
```requests.get("http://127.0.0.1:5000/api/get_menu", json={"username": "ulik", "token": ulik_t}).json()```
#### Оформление заказа
```requests.post("http://127.0.0.1:5000/api/add_order", json={"username": "ulik", "token": ulik_t, "dishes": [{"burger": 1, "cheese balls": 2}]})```
#### Измение блюд
```res = requests.patch("http://127.0.0.1:5000/api/update_dish", json={"username": "zhora", "token": zhora_t, "name": "cheese balls", "quantity": 5})```
```res = requests.patch("http://127.0.0.1:5000/api/update_dish", json={"username": "irlan", "token": irlan_t, "name": "potato", "price": 170})```

#### Изменение статутса заказа
```requests.patch("http://127.0.0.1:5000/api/update_order", json={"username": "irlan", "token": irlan_t, "order_id": 1, "status": "processing"})```







